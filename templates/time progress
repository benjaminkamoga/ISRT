<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Premise Data Page ‚Äì Overview & Key Features</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body {
    background-color: #f8f9fa;
    font-family: Arial, sans-serif;
    padding: 20px;
  }

  /* Main container */
  .note-card {
    max-width: 1200px;
    margin: 0 auto 40px;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    background-color: #fff;
  }

  /* Title & intro */
  .note-title {
    color: #28a745;
    font-weight: 700;
    font-size: 1.8rem;
    margin-bottom: 10px;
    text-align: justify;
  }

  .intro-text {
    text-align: justify;
    color: #555;
    font-size: 1rem;
    margin-bottom: 20px;
  }

  /* Premises image */
.premises-image {
    display: block;
    width: 100%;       /* Full width of the card */
    height: auto;      /* Maintain aspect ratio */
    margin-bottom: 30px;
    border-radius: 10px;
    border: 1px solid #ddd;
    box-shadow: 0 4px 10px rgba(0,0,0,0.15);
}


  /* Features grid */
  .feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
  }

  /* Feature cards */
  .feature-card {
    background: #f0f0f0;
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    transition: transform .2s;
  }
  .feature-card:hover {
    transform: translateY(-5px);
  }

  .feature-icon {
    font-size: 36px;
    margin-bottom: 10px;
  }
  .feature-title {
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 8px;
    color: #007bff;
  }

  /* Flow grid */
  .flow-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px,1fr));
    gap: 20px;
    margin-top: 30px;
  }
  .flow-step {
    border-radius: 12px;
    padding: 15px;
    background: #fff;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    text-align: center;
  }
  .flow-step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #28a745;
    color: #fff;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 10px;
  }

  /* 3-image gallery */
  .image-gallery {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-top: 40px;
  }
  .image-left {
  grid-row: span 2;
  display: flex;
  flex-direction: column;
  justify-content: space-between; /* top: descriptive card, bottom: map image */
}

.descriptive-card {
  background: #f0f0f0;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  flex: 1; /* make it grow to fill the space */
  margin-bottom: 15px;
}
.image-left img {
  width: 100%;
  border-radius: 12px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.15);
  border: 1px solid #ddd;
}


.image-left {
  grid-row: span 2;
  display: flex;
  flex-direction: column;
  justify-content: flex-end; /* keeps bottom aligned with right-down image */
}
.image-left .feature-card {
  background: #f0f0f0;
  padding: 15px;
  border-radius: 12px;
  margin-bottom: 15px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

  .image-gallery img {
    width: 100%;
    border-radius: 12px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.15);
    border: 1px solid #ddd;
    transition: transform .2s ease-in-out;
    cursor: pointer;
  }
  .image-gallery img:hover {
    transform: scale(1.05);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .image-gallery {
      grid-template-columns: 1fr;
    }
    .image-left {
      grid-row: auto;
    }
  }
</style>
</head>
<body>

<div class="note-card">
  <!-- Title & Intro -->
  <h3 class="note-title">Premise Data Page ‚Äì Overview & Key Features</h3>
  <p class="intro-text">
    The <strong>Premise Data Page</strong> provides a structured database of all registered premises,
    serving as the foundation for inspections, reporting, and analysis.
    It enables users to efficiently view, filter, update, and manage premise records while supporting
    accurate data-driven decision-making.
  </p>

  <!-- Premises Image -->
<img src="{{ url_for('static', filename='images/notes/premises.png') }}"
     alt="Premises Overview"
     class="premises-image">


  <!-- Features Grid -->
  <div class="feature-grid">

    <!-- Premise Records -->
    <div class="feature-card">
      <div class="feature-icon">üè¢</div>
      <div class="feature-title">Premise Records</div>
      <div>View all premises with name, category, location, VR, and actions.</div>
    </div>

    <!-- Filters & Search -->
    <div class="feature-card">
      <div class="feature-icon">üîç</div>
      <div class="feature-title">Filters & Search</div>
      <div>Filter by Region, District, Category, VR Type, Physical Location, or search by name.</div>
    </div>

    <!-- Add / Edit Premises -->
    <div class="feature-card">
      <div class="feature-icon">‚ûï</div>
      <div class="feature-title">Add / Edit Premises</div>
      <div>Add new or edit existing premises quickly through modals.</div>
    </div>

    <!-- Observations -->
    <div class="feature-card">
      <div class="feature-icon">üìä</div>
      <div class="feature-title">Observations</div>
      <div>Record inspections, defects, dates, and monetary values.</div>
    </div>

    <!-- Map View -->
    <div class="feature-card">
      <div class="feature-icon">üó∫Ô∏è</div>
      <div class="feature-title">Map View</div>
      <div>Visualize premises on a map for easy reference.</div>
    </div>

    <!-- Cart -->
    <div class="feature-card">
      <div class="feature-icon">üõí</div>
      <div class="feature-title">Cart</div>
      <div>Select multiple premises, see live count, and view summary popup.</div>
    </div>

    <!-- Export -->
    <div class="feature-card">
      <div class="feature-icon">üì•</div>
      <div class="feature-title">Export</div>
      <div>Download filtered premises list as Excel file.</div>
    </div>

    <!-- Intensity Cards -->
<div class="feature-card">
  <div class="feature-icon">üü•‚öΩ</div>
  <div class="feature-title">Intensity Cards</div>
  <div>Inspection & Defects Summary<br>View real-time summaries of inspected premises, defect counts, and financial impacts.</div>
</div>


  </div>

  <!-- How to Use -->
  <div class="sub-section" style="margin-top:40px; font-weight:600; font-size:1.3rem; color:#333;">How to Use</div>
  <div class="flow-grid">
    <div class="flow-step">
      <div class="flow-step-number">1</div>
      <div><strong>Filter Premises</strong></div>
      <div>Select Region ‚Üí District ‚Üí Category ‚Üí Physical Location. Search by name. Toggle VR Type.</div>
    </div>
    <div class="flow-step">
      <div class="flow-step-number">2</div>
      <div><strong>Add Premise</strong></div>
      <div>Click Add Premise, fill details, save or cancel.</div>
    </div>
    <div class="flow-step">
      <div class="flow-step-number">3</div>
      <div><strong>Edit / Delete</strong></div>
      <div>Use the Actions column to modify or remove premises.</div>
    </div>
    <div class="flow-step">
      <div class="flow-step-number">4</div>
      <div><strong>Add Observations</strong></div>
      <div>Click Observation ‚Üí select date & defects ‚Üí enter values ‚Üí save.</div>
    </div>
    <div class="flow-step">
      <div class="flow-step-number">5</div>
      <div><strong>View Observations</strong></div>
      <div>Click View Observations to see all historical inspection data.</div>
    </div>
    <div class="flow-step">
      <div class="flow-step-number">6</div>
      <div><strong>Map</strong></div>
      <div>Click Show Map or Map button in table to visualize location.</div>
    </div>
    <div class="flow-step">
      <div class="flow-step-number">7</div>
      <div><strong>Export</strong></div>
      <div>Download filtered premises list via Export to Excel.</div>
    </div>
    <div class="flow-step">
      <div class="flow-step-number">8</div>
      <div><strong>Cart</strong></div>
      <div>Selected premises appear in cart. Click to view summary popup.</div>
    </div>
  </div>

  <!-- Existing 3-Image Gallery -->
<div class="image-gallery">
  <div class="image-left d-flex flex-column justify-content-between">
    <!-- Descriptive Card -->
    <div class="feature-card descriptive-card">
      <div class="feature-title">Description</div>
      <div>
        Explain the three images: Map, Add Observation, and View Observations.
      </div>
    </div>
    <!-- Left Image (Map) -->
    <img src="{{ url_for('static', filename='images/notes/map.png') }}" alt="Map View">
  </div>

  <!-- Right Images -->
  <div>
    <img src="{{ url_for('static', filename='images/notes/addobservation.png') }}" alt="Add Observation">
  </div>
  <div>
    <img src="{{ url_for('static', filename='images/notes/viewobservations.png') }}" alt="View Observations">
  </div>
</div>

<!-- Wide Map2 Image with Description -->
<div style="margin-top: 30px;">
  <p style="font-weight:600; font-size:1rem; color:#333; margin-bottom:10px;">
    The below sample map shows how a user can navigate toward a premise location; 
    the red location icon indicates the premise location, and the blue dots show a direction from the user's position toward that premise.
  </p>
  <img src="{{ url_for('static', filename='images/notes/map2.png') }}" 
       alt="Map 2 View" 
       style="width:100%; border-radius:12px; box-shadow:0 3px 10px rgba(0,0,0,0.15); border:1px solid #ddd;">
</div>

<!-- Observations & Calculations Explanation Card -->
<div class="feature-card" style="margin-top:20px; max-height:600px; overflow-y:auto;">
  <div class="feature-title" style="font-size:1.2rem; margin-bottom:10px;">How Observations and Calculations Work</div>
  <div style="text-align:justify; font-size:0.95rem; line-height:1.5; color:#333;">

    <p>When you record an observation for a premise, the system automatically calculates several metrics that help you understand the level of compliance and risk for that premise. Here‚Äôs how it works:</p>

    <h6>1. Recording Observations</h6>
    <ul>
      <li>For each premise, you can add observations on a specific date.</li>
      <li>Observations include checking for defects such as GOT Medicines, Unregistered Medicines, No Qualified Personnel, and other issues.</li>
      <li>Some defects allow you to enter a monetary value in Tanzanian Shillings (Tsh) to quantify the severity.</li>
      <li>If no issues are found, you can select ‚ÄúNone‚Äù, and the system treats this observation as having no defects.</li>
    </ul>

    <h6>2. Intensity</h6>
    <p>Each type of defect has a predefined intensity value that represents how serious the issue is. The total intensity for an observation is calculated as the sum of intensity values of all selected defects:</p>
    <p><strong>Total Intensity = ‚àë(Intensity of each selected defect)</strong></p>
    <p>Observations marked as ‚ÄúNone‚Äù automatically have an intensity of 0.</p>

    <h6>3. Policy Violation Index (PVI)</h6>
    <p>The system calculates three PVI values for each observation:</p>
    <ul>
      <li><strong>Raw PVI:</strong> Each defect with a monetary value contributes based on its assigned weight:<br>
          <strong>Raw PVI = ‚àë (Weight of defect / 100 √ó Defect Value (Tsh))</strong></li>
      <li><strong>Absolute PVI (%):</strong> The raw PVI is scaled against the maximum possible PVI for all weighted defects:<br>
          <strong>Absolute PVI (%) = (Raw PVI / Maximum Policy Value) √ó 100</strong></li>
      <li><strong>Relative PVI (%):</strong> Compares a premise‚Äôs total raw PVI to the maximum total raw PVI among premises in the same district (or all premises if no district is selected):<br>
          <strong>Relative PVI (%) = (Premise Total Raw PVI / Maximum Raw PVI in Set) √ó 100</strong></li>
    </ul>

    <h6>4. Aggregating Observations</h6>
    <p>Each premise can have multiple observations over time. The system calculates total and average values across all observations:</p>
    <ul>
      <li>Total Intensity = ‚àëIntensity of all observations</li>
      <li>Average Intensity = Total Intensity / Number of Observations</li>
      <li>Total Raw PVI = ‚àëRaw PVI of all observations</li>
      <li>Average Raw PVI = Total Raw PVI / Number of Observations</li>
      <li>Total Absolute PVI = ‚àëAbsolute PVI of all observations</li>
      <li>Average Absolute PVI = Total Absolute PVI / Number of Observations</li>
    </ul>

    <h6>5. Violation Rate (VR)</h6>
    <p>The Violation Rate combines intensity and PVI to give a single compliance risk score:</p>
    <ul>
      <li>Absolute VR = (Average Intensity √ó Intensity Weight) + (Average Absolute PVI √ó PVI Weight)</li>
      <li>Relative VR = (Average Intensity √ó Intensity Weight) + (Relative PVI √ó PVI Weight)</li>
      <li>By default, the weights are 70% for intensity and 30% for PVI, but these can be configured in the system.</li>
    </ul>

    <h6>6. Intensity Cards</h6>
    <p>Each premise has an Intensity Card, which provides a quick visual indicator of compliance level. The card color is based on the latest observations and average intensity:</p>
    <ul>
      <li>Green ‚Üí low intensity, low risk</li>
      <li>Blue ‚Üí low to moderate intensity</li>
      <li>Yellow ‚Üí moderate intensity</li>
      <li>Red ‚Üí high intensity or critical defects present</li>
    </ul>

    <h6>7. Key Points</h6>
    <ul>
      <li>Intensity shows how severe the defects are.</li>
      <li>PVI measures policy violation in absolute and relative terms.</li>
      <li>Violation Rate (VR) gives a single score combining defect severity and policy violation.</li>
      <li>Intensity Cards give a visual summary of compliance and risk.</li>
      <li>All calculations update automatically when you add or edit observations, or when you filter premises by region, district, or category.</li>
    </ul>

  </div>
</div>


 

</div>
</body>
</html>
